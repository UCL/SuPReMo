<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuPReMo: Getting started with SuPReMo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rtic.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SuPReMo
   &#160;<span id="projectnumber">0.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Getting started with SuPReMo </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md11">Building from source</a></li>
<li class="level1"><a href="#autotoc_md12">Dependencies</a><ul><li class="level2"><a href="#autotoc_md13">CMake</a></li>
<li class="level2"><a href="#autotoc_md14">Nifty-Reg</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md15">Building SuPReMo on a Linux system</a><ul><li class="level2"><a href="#autotoc_md16">Building nifty-reg</a></li>
<li class="level2"><a href="#buildingsupremo">Building SuPReMo</a></li>
<li class="level2"><a href="#autotoc_md17">Running the tests included in SuPReMo</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p ><a class="anchor" id="md_motion_docu_GettingStarted"></a></p>
<h1><a class="anchor" id="autotoc_md11"></a>
Building from source</h1>
<h1><a class="anchor" id="autotoc_md12"></a>
Dependencies</h1>
<h2><a class="anchor" id="autotoc_md13"></a>
CMake</h2>
<p >The cross platform make-file generator is used to manage the build on various platforms. CMake can be downloaded <a href="https://cmake.org">here</a>. Please install a reasonably recent version on your system, a minimum of version 3.3 is required by the CMakeLists.txt.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Nifty-Reg</h2>
<p >During the build step SuPReMo links to the libraries of <em>nifty-reg</em> which is available <a href="https://github.com/KCL-BMEIS/niftyreg">here</a> and the build will be described below.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Building SuPReMo on a Linux system</h1>
<p >The steps below describe how to build SuPReMo (and nifty-reg) on a Linux system. We perform an out-of source build for both, nifty-reg and SuPReMo. Choose a location where to download and build the software packages, we will name this <code>WORK_DIR</code> in the instructions below.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Building nifty-reg</h2>
<p >To build the required <em>nifty-reg</em> libraries in the <code>WORK_DIR</code> download the source code for instacne using git, create a build and an install directory and run <code>ccmake</code> or <code>cmake-gui</code> in the build directory to configure the build. <br  />
</p>
<div class="fragment"><div class="line">cd WORK_DIR</div>
<div class="line">git clone --single-branch --branch 28-sliding-regions https://github.com/KCL-BMEIS/niftyreg</div>
<div class="line">mkdir niftyreg_build</div>
<div class="line">mkdir niftyreg_install</div>
<div class="line">cd niftyreg_build</div>
<div class="line">ccmake ../niftyreg</div>
</div><!-- fragment --><p ><b>Note:</b> Using the branch <code>28-sliding-regions</code> fixes some open-mp errors that occured with gcc version 9, however, gcc version 7 works well with the master branch. When using an older compiler you can chose to replace the above git-clone with the simpler one below. The branch sliding-regions is not a pre-requisite to utilise the sliding implementation of SuPReMo: </p><div class="fragment"><div class="line">git clone https://github.com/KCL-BMEIS/niftyreg</div>
</div><!-- fragment --><p >Configure the nifty-reg build (by pressing <code>c</code>) and set the following options within ccmake using the arrow keys to move up and down the options, select one by pressing <code>enter</code> and then type the required option value and confirm with <code>enter</code>. When all parameters are set, press <code>c</code> and then <code>g</code> to generate the <code>Makefile</code>. The cmake-gui is potentially more convenient to use but the result will be the same.</p>
<ul>
<li><code>BUILD_ALL_DEP = ON</code></li>
<li><code>BUILD_SHARED_LIBS = OFF</code></li>
<li><code>BUILD_TESTING = OFF</code></li>
<li><code>CMAKE_BUILD_TYPE = Release</code></li>
<li><code>CMAKE_INSTALL_PREFIX = WORK_DIR/niftyreg_install</code></li>
<li><code>USE_CUDA = OFF</code></li>
<li><code>USE_OPENCL = OFF</code></li>
<li><code>USE_OPENMP = ON</code></li>
<li><code>USE_SSE = ON</code></li>
</ul>
<p >Still within the build-directory start the build and install the binaries to the directory defined in the configuration step above (<code>WORK_DIR/niftyreg_install</code>) </p><div class="fragment"><div class="line">make</div>
<div class="line">make install</div>
</div><!-- fragment --><p> to start the build process. On a multi-core system you may speed up the build by allowing parallel build steps where possible by usint the option <code>-j4</code>, for four parallel builds for instance.</p>
<p >To check that the installation was successful, you can get a help message from nifty-reg: </p><div class="fragment"><div class="line">cd WORK_DIR/niftyreg_install/bin/runSupremo</div>
<div class="line">reg_f3d -h</div>
</div><!-- fragment --><p> If a detailed usage message shows up on the command line, you are good to proceed.</p>
<h2><a class="anchor" id="buildingsupremo"></a>
Building SuPReMo</h2>
<p >The build steps for SuPReMo are very similar to the ones required for nifty-reg, namely, obtaining the source code, configuring the build, building and installing.</p>
<div class="fragment"><div class="line">cd WORK_DIR</div>
<div class="line">git clone https://github.com/UCL/SuPReMo</div>
<div class="line">mkdir SuPReMo_build</div>
<div class="line">mkdir SuPReMo_install</div>
<div class="line">cd SuPReMo_build</div>
<div class="line">ccmake ../SuPReMo</div>
</div><!-- fragment --><p >Configure SuPReMo with the following optoins. Note however, that since nifty-reg is a dependency of SuPReMo, on the first connfiguration attempt an error will be raised, simply because the install path of nifty-reg is not known to cmake at this stage. Providing it during the configuration solves this. For this set the variable NiftyReg_DIR to <code>WORK_DIR/niftyreg_install</code> and type <code>c</code>. The variables <code>NiftyReg_INCLUDE_DIR</code> and <code>NiftyReg_TOOLS_LIBRARY</code> will be filled in automatically.</p><ul>
<li><code>BUILD_TESTING = ON/OFF</code> depending on if you want to run the tests on your local system</li>
<li><code>CMAKE_BUILD_TYPE = Release</code></li>
<li><code>CMAKE_INSTALL_PREFIX = WORK_DIR/SuPReMo_install/</code></li>
<li><code>NiftyReg_DIR = WORK_DIR/niftyreg_install/</code></li>
<li><code>USE_OPENMP = ON</code></li>
</ul>
<p >After the configuration a message will be displayed saying <em>niftyreg found</em>. This must be acknowledged wtith <code>e</code>.</p>
<p >After the configuraiton, SuPReMo can be build and installed: </p><div class="fragment"><div class="line">make</div>
<div class="line">make install</div>
</div><!-- fragment --><p >If successful you will have the installation in <code>WORK_DIR/SuPReMo_install</code> and the main executable in the folder <code>bin</code>. You display SuPReMo's usage message on the command line by runing </p><div class="fragment"><div class="line">WORK_DIR/SuPReMo_install/bin/runSupremo -h</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
Running the tests included in SuPReMo</h2>
<p >If you want to check your local SuPReMo installation more thoroughly, you can run the tests using ctest. Navigate to the build-directory and call ctest as follows: </p><div class="fragment"><div class="line">ctest --output-on-failure -C Release</div>
</div><!-- fragment --><p> Which will generate an output similar to this: </p><div class="fragment"><div class="line">Test project WORK_DIR/SuPReMo_build</div>
<div class="line">      Start  1: ImagePyramidTest_2D_L0</div>
<div class="line"> 1/23 Test  #1: ImagePyramidTest_2D_L0 ......................................   Passed    0.11 sec</div>
<div class="line">      Start  2: ImagePyramidTest_2D_L1</div>
<div class="line"> 2/23 Test  #2: ImagePyramidTest_2D_L1 ......................................   Passed    0.10 sec</div>
<div class="line">      Start  3: ImagePyramidTest_2D_L2</div>
<div class="line"> 3/23 Test  #3: ImagePyramidTest_2D_L2 ......................................   Passed    0.09 sec</div>
<div class="line">      Start  4: ImagePyramidTest_3D_L0</div>
<div class="line"> 4/23 Test  #4: ImagePyramidTest_3D_L0 ......................................   Passed    0.15 sec</div>
<div class="line">      Start  5: ImagePyramidTest_3D_L1</div>
<div class="line"> 5/23 Test  #5: ImagePyramidTest_3D_L1 ......................................   Passed    0.15 sec</div>
<div class="line">      Start  6: ImagePyramidTest_3D_L2</div>
<div class="line"> 6/23 Test  #6: ImagePyramidTest_3D_L2 ......................................   Passed    0.18 sec</div>
<div class="line">      Start  7: ImageSimilarityMeasure_2D</div>
<div class="line"> 7/23 Test  #7: ImageSimilarityMeasure_2D ...................................   Passed    0.08 sec</div>
<div class="line">      Start  8: BSplineTransformation_2D</div>
<div class="line"> 8/23 Test  #8: BSplineTransformation_2D ....................................   Passed    0.26 sec</div>
<div class="line">      Start  9: BSplineTransformation_3D</div>
<div class="line"> 9/23 Test  #9: BSplineTransformation_3D ....................................   Passed    0.49 sec</div>
<div class="line">      Start 10: AdjointTransformationTest</div>
<div class="line">10/23 Test #10: AdjointTransformationTest ...................................   Passed    0.32 sec</div>
<div class="line">      Start 11: SlidingBSplineTransformation_3D_DVF</div>
<div class="line">11/23 Test #11: SlidingBSplineTransformation_3D_DVF .........................   Passed    2.48 sec</div>
<div class="line">      Start 12: SlidingBSplineTransformation_3D_GOCT_GRAD</div>
<div class="line">12/23 Test #12: SlidingBSplineTransformation_3D_GOCT_GRAD ...................   Passed    1.64 sec</div>
<div class="line">      Start 13: ObjectiveFunctionTest</div>
<div class="line">13/23 Test #13: ObjectiveFunctionTest .......................................   Passed    9.58 sec</div>
<div class="line">      Start 14: WeightedAverageMoCoRecoTest</div>
<div class="line">14/23 Test #14: WeightedAverageMoCoRecoTest .................................   Passed    7.29 sec</div>
<div class="line">      Start 15: SuperResolutionIBPRestartMoCoReco_initial_Test</div>
<div class="line">15/23 Test #15: SuperResolutionIBPRestartMoCoReco_initial_Test ..............   Passed    8.32 sec</div>
<div class="line">      Start 16: SuperResolutionIBPRestartMoCoReco_firstIt_Test</div>
<div class="line">16/23 Test #16: SuperResolutionIBPRestartMoCoReco_firstIt_Test ..............   Passed    7.28 sec</div>
<div class="line">      Start 17: SuperResolutionIBPUpdateMoCoReco_firstIt_Test</div>
<div class="line">17/23 Test #17: SuperResolutionIBPUpdateMoCoReco_firstIt_Test ...............   Passed    8.09 sec</div>
<div class="line">      Start 18: LowResolutionImageAcquisitionSimulationSAG</div>
<div class="line">18/23 Test #18: LowResolutionImageAcquisitionSimulationSAG ..................   Passed    0.07 sec</div>
<div class="line">      Start 19: LowResolutionImageAcquisitionSimulationAXI</div>
<div class="line">19/23 Test #19: LowResolutionImageAcquisitionSimulationAXI ..................   Passed    0.08 sec</div>
<div class="line">      Start 20: LowResolutionImageAcquisitionSimulationMinSizeImgAllocSAG</div>
<div class="line">20/23 Test #20: LowResolutionImageAcquisitionSimulationMinSizeImgAllocSAG ...   Passed    0.16 sec</div>
<div class="line">      Start 21: LowResolutionImageAcquisitionSimulationMinSizeImgAllocAXI</div>
<div class="line">21/23 Test #21: LowResolutionImageAcquisitionSimulationMinSizeImgAllocAXI ...   Passed    0.15 sec</div>
<div class="line">      Start 22: testLowResolutionImageAcquisitionAdjointSAG</div>
<div class="line">22/23 Test #22: testLowResolutionImageAcquisitionAdjointSAG .................   Passed    0.19 sec</div>
<div class="line">      Start 23: testLowResolutionImageAcquisitionAdjointAXI</div>
<div class="line">23/23 Test #23: testLowResolutionImageAcquisitionAdjointAXI .................   Passed    0.20 sec</div>
<div class="line"> </div>
<div class="line">100% tests passed, 0 tests failed out of 23</div>
<div class="line"> </div>
<div class="line">Total Test time (real) =  47.75 sec</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.16-->
<!-- start footer part -->
<div class="footer">
  <span class="credits">
    <a href="https://www.ucl.ac.uk/medical-physics-biomedical-engineering/research/research-groups/radiotherapy-image-computing-group-rtic" target="_blank">The Radiotherapy Image Computing Group,</a>
    doxygen 
    <a href="https://github.com/ZenCPP/zen-doxygen-theme" target="_blank">Zen theme</a>
    made by
    <a href="https://github.com/samvv/" target="_blank">Sam Vervaeck</a>
 </span>
  <hr class="footer"/>
  <address class="footer">
    Generated by &#160;
    <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen"/>
    </a> 1.9.5
  </address>
</div>
</body>
</html>
