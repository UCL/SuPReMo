name: Build
on:
  push:
jobs:
  build-project:
    name: Build Project
    runs-on: ubuntu-latest
    steps:
      - name: Checkout dependency nifty-reg
        uses: actions/checkout@v4.1.1
        with:
            repository: KCL-BMEIS/niftyreg
            path: ${{github.workspace}}/niftyregSource

      - name: Configure build nifty-reg 
        uses: threeal/cmake-action@v1.3.0
        with:
            run-build: true
            run-test: false
            options:  CMAKE_INSTALL_PREFIX=${{github.workspace}}/niftyRegInstall BUILD_ALL_DEP=ON
            source-dir: ${{github.workspace}}/niftyregSource
            build-dir: ${{github.workspace}}/niftyregBuild

      - name: Install dependencies nifty-reg 
        run: |
              cd ${{github.workspace}}/niftyregBuild
              pwd
              ls -la
              make install

      - name: Checkout repository
        uses: actions/checkout@v4.1.1
        with:
            path: ${{github.workspace}}/SuPReMoSource


      - name: Configure build SuPReMo
        uses: threeal/cmake-action@v1.3.0
        with: 
            run-build: true
            run-test: true
            options:  NiftyReg_DIR=${{github.workspace}}/niftyRegInstall 
            source-dir: ${{github.workspace}}/SuPReMoSource
            build-dir: ${{github.workspace}}/SuPReMoBuild

